<!DOCTYPE html> 
<html> 
<head> <title>Probabilistic models</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">Probabilistic models</h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">á</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">January 7, 2020</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Funtionality</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">Static models</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-50003" id="QQ2-1-5">Adaptive models</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-60004" id="QQ2-1-6">Encoding</a></span>
<br />   <span class="sectionToc" >5 <a 
href="#x1-70005" id="QQ2-1-7">Decoding</a></span>
<br />   <span class="sectionToc" >6 <a 
href="#x1-90006" id="QQ2-1-9">Initially empty models</a></span>
<br />   <span class="sectionToc" >7 <a 
href="#x1-100007" id="QQ2-1-10">Encoder</a></span>
<br />   <span class="sectionToc" >8 <a 
href="#x1-110008" id="QQ2-1-11">Decoder</a></span>
<br />   <span class="sectionToc" >9 <a 
href="#x1-130009" id="QQ2-1-13">Models with memory</a></span>
<br />   <span class="sectionToc" >10 <a 
href="#x1-1400010" id="QQ2-1-14">Encoder</a></span>
<br />   <span class="sectionToc" >11 <a 
href="#x1-1600011" id="QQ2-1-17">Decoder</a></span>
<br />   <span class="sectionToc" ><a 
href="#Q1-1-20">References</a></span>
   </div>
<!--l. 6--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Funtionality</h3>
     <ul class="itemize1">
     <li class="itemize">Compute the probabilities of the symbols (see <a 
href="https://vicente-gonzalez-ruiz.github.io/symbol_compression/#x1-20001" >Symbol Encoding</a>).
                                                                  

                                                                  
     </li>
     <li class="itemize">Both, the encoder and the decoder must be syncronized.</li></ul>
<!--l. 14--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>Static models</h3>
     <ul class="itemize1">
     <li class="itemize">Static   models   are   the   simplest   ones   because   they   suppose   that
     the   probabilities   of   the   symbols   remain   constant   through   the
     compression/decompression.
     </li>
     <li class="itemize">In this case, variable-length code-words can be precomputed.
     </li>
     <li class="itemize">Static models are very common in codecs such as JPEG and MPEG (audio
     and video).</li></ul>
<!--l. 24--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-40002"></a>Let’s go the the lab!</h3>
<!--l. 25--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-4002x1">Clone <a 
href="https://github.com/vicente-gonzalez-ruiz/basic-compression-tools" class="url" ><span 
class="ectt-1000">https://github.com/vicente-gonzalez-ruiz/basic-compression-tools</span></a>
     and run <span 
class="ectt-1000">make huff_s0</span>.
     </li>
     <li 
  class="enumerate" id="x1-4004x2">Encode the images of the table below that can be found at <a 
href="http://www.hpca.ual.es/~vruiz/images/" >The Test Image
     Corpus</a> using the codec.
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-1">
         Codec | lena boats pepers zelda
      <br />----------+------------------------
      <br />      RLE | ....  ....   ....  ....
      <br />  BWT+RLE | ....  ....   ....  ....
      <br />     LZSS | ....  ....   ....  ....
      <br />      LZW | ....  ....   ....  ....
      <br />  huff_s0 | ....  ....   ....  ....
</div>
     <!--l. 40--><p class="nopar" > Continue ﬁlling the table ...
     </p></li>
     <li 
  class="enumerate" id="x1-4006x3">Check that the <span 
class="ectt-1000">huff_s0 </span>codec is lossless.</li></ol>
<!--l. 45--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-50003"></a>Adaptive models</h3>
     <ul class="itemize1">
     <li class="itemize">The probabilities of the symbols are computed while they arrive to the
     compressor.
     </li>
     <li class="itemize">In general, the compression ratios that adaptive models reach are better
     than                                    static                                    model’s
     ones, because the probabilities of the symbols are localy computed (think
     of the sequence ‘aaaaaaaaaaaaaabbbbbbbbbbbbbbb‘).</li></ul>
<!--l. 52--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-60004"></a>Encoding</h3>
<!--l. 53--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-6002x1">Asign the same probability to all the symbols of the source alphabet.
     </li>
     <li 
  class="enumerate" id="x1-6004x2">While the input if not exhausted:
                                                                  

                                                                  
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-6006x1">Encode the next symbol.
         </li>
         <li 
  class="enumerate" id="x1-6008x2">Update (increase) its probability.</li></ol>
     </li></ol>
<!--l. 62--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-70005"></a>Decoding</h3>
<!--l. 63--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-7002x1">Identical to the step 1 of the encoder.
     </li>
     <li 
  class="enumerate" id="x1-7004x2">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-7006x1">Decode the next symbol.
         </li>
         <li 
  class="enumerate" id="x1-7008x2">Identical to the step 2.b of the encoder.</li></ol>
     </li></ol>
<!--l. 72--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-80005"></a>Let’s go the the lab!</h3>
<!--l. 73--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-8002x1">Continue ﬁlling the table:
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-2">
         Codec | lena boats pepers zelda Average
      <br />----------+--------------------------------
      <br />        : |    :     :      :     :       :
      <br />  huff_s0 | ....  ....   ....  ....    ....
      <br />  huff_a0 | ....  ....   ....  ....    ....
      <br /> arith_a0 | ....  ....   ....  ....    ....
</div>
     <!--l. 82--><p class="nopar" >
     </p></li>
     <li 
  class="enumerate" id="x1-8004x2">Remember to check that both codecs are lossless.</li></ol>
<!--l. 86--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-90006"></a>Initially empty models</h3>
     <ul class="itemize1">
     <li class="itemize">The smaller the number of symbols used by the model, the higher the
     probabilities, and therefore, the better the compression ratios.
     </li>
     <li class="itemize">An initially empty model only stores the <!--l. 91--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">ESC</mi></math>(cape)
     symbol (a symbol that it is used by the encoder only when a new symbol
     is found and therefore, it must be part of the encoder’s and decoder’s
     models).
     </li>
     <li class="itemize">We assume that arithmetic coding is used and therefore, when we input or
     output <!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>,
     we are transmitting <!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     bits of code.</li></ul>
<!--l. 98--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-100007"></a>Encoder</h3>
<!--l. 99--><p class="noindent" >
                                                                  

                                                                  
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-10002x1">Set the probability of the <!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">ESC</mi></math>
     symbol to <!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>0</mn></math>
     (and the probability of the rest of the symbols to <!--l. 101--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>0</mn></math>).
     </li>
     <li 
  class="enumerate" id="x1-10004x2">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-10006x1"><!--l. 104--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo></math>
         next symbol.
         </li>
         <li 
  class="enumerate" id="x1-10008x2">If <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>
         has been found before, then:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-10010x1">Output <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
             (encode).</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-10012x3">Else:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-10014x1">Output <!--l. 111--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
             </li>
             <li 
  class="enumerate" id="x1-10016x2">Output a raw symbol <!--l. 112--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>.</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-10018x4">Update <!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.</li></ol>
     </li></ol>
<!--l. 118--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-110008"></a>Decoder</h3>
<!--l. 119--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-11002x1">Identical to the step 1 of the encoder.
     </li>
     <li 
  class="enumerate" id="x1-11004x2">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-11006x1"><!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">←</mo></math>
         next code-word.
         </li>
         <li 
  class="enumerate" id="x1-11008x2">Decode <!--l. 124--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>.
                                                                  

                                                                  
         </li>
         <li 
  class="enumerate" id="x1-11010x3">If <!--l. 125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="monospace">ESC</mi></math>,
         then:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-11012x1">Input a raw symbol <!--l. 127--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>.</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-11014x4">Update <!--l. 129--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-11016x5">Output <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>.</li></ol>
     </li></ol>
<!--l. 134--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-120008"></a>Let’s go the the lab!</h3>
<!--l. 135--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-12002x1"><span 
class="ectt-1000">make arith-n-c </span>and <span 
class="ectt-1000">make arith-n-d</span>.
     </li>
     <li 
  class="enumerate" id="x1-12004x2">
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-3">
              Codec | lena boats pepers zelda Average
      <br />---------------+--------------------------------
      <br />             : |    :     :      :     :       :
      <br />arith-n-c -o 0 | ....  ....   ....  ....    .... #1
      <br /> BWT | ahuff_0 | ....  ....   ....  ....    ....
      <br />      bzip2 -9 | ....  ....   ....  ....    .... #2
      <br />       gzip -9 | ....  ....   ....  ....    .... #3
      <br />
      <br />#1 -&#x003E; Similar to arith_a0 but using an initially
      <br />      empty model.
      <br />
      <br />#2 -&#x003E; Similar to BWT | ahuff_0
      <br />
      <br />#3 -&#x003E; Similar to LZ77 + ahuff_0
</div>
     <!--l. 153--><p class="nopar" >
     </p></li>
     <li 
  class="enumerate" id="x1-12006x3">Check the reversibility.</li></ol>
<!--l. 157--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9   </span> <a 
 id="x1-130009"></a>Models with memory</h3>
     <ul class="itemize1">
     <li class="itemize">In most cases, the probability of a symbol depends on its neighborhood
     (context).
     </li>
     <li class="itemize">The higher the memory of the model (the context), the higher the accuracy
     of the predictions (probabilities), and therefore, the lower the length of
     the code-words <span class="cite">[<a 
href="#Xcleary1984data">1</a>]</span>.
     </li>
     <li class="itemize">Let <!--l. 164--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
     the last <!--l. 164--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
     encoded symbols and <!--l. 164--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     the probability that the symbol <!--l. 165--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>
     follows the context <!--l. 165--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>.
                                                                  

                                                                  
     </li>
     <li class="itemize">Let <!--l. 166--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>
     the maximal order of the prediction (i.e. the largest number of symbols of
     <!--l. 167--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
     that are going to be used as the actual context). Notice that <!--l. 168--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-ord">∅</mo></math>
     and the model has no memory.
     </li>
     <li class="itemize">We suppose that arithmetic coding is used and therefore, when we input or
     output <!--l. 171--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>,
     we are transmitting <!--l. 171--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     bits of code.
     </li>
     <li class="itemize">Let <!--l. 172--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math>
     the size of the source alphabet.</li></ul>
<!--l. 175--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">10   </span> <a 
 id="x1-1400010"></a>Encoder</h3>
<!--l. 176--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-14002x1">Create an empty model for every possible context of length <!--l. 177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn> <mo 
class="MathClass-rel">≤</mo> <mi 
>i</mi> <mo 
class="MathClass-rel">≤</mo> <mi 
>k</mi></math>.
     </li>
     <li 
  class="enumerate" id="x1-14004x2">Create an non-empty model for <!--l. 178--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><mn>1</mn></math>.
     </li>
     <li 
  class="enumerate" id="x1-14006x3">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-14008x1"><!--l. 181--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo></math>
         Input <!--l. 181--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>r</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
         bits. # Input a symbol.
         </li>
         <li 
  class="enumerate" id="x1-14010x2"><!--l. 182--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>k</mi></math>
         (except for the ﬁrst symbol, where <!--l. 183--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>0</mn></math>).
         </li>
         <li 
  class="enumerate" id="x1-14012x3"><!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>k</mi></math>
         (except for the ﬁrst symbol, where
         <!--l. 185--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>0</mn></math>):
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-14014x1">Output <!--l. 187--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mstyle 
class="text"><mtext  >ESC</mtext></mstyle><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
                                                                  

                                                                  
             </li>
             <li 
  class="enumerate" id="x1-14016x2">Update <!--l. 188--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mstyle 
class="text"><mtext  >ESC</mtext></mstyle><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
             </li>
             <li 
  class="enumerate" id="x1-14018x3">Update <!--l. 189--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
             (insert <!--l. 189--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>
             into the <!--l. 189--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
             context).
             </li>
             <li 
  class="enumerate" id="x1-14020x4"><!--l. 190--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>i</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></math>.</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-14022x4">Output <!--l. 192--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
         The symbols that were found in the models for contexts with order
         <!--l. 193--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>i</mi></math> must be excluded
         of the actual (<!--l. 193--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>)
         context-model because, for sure,
         <!--l. 193--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>
         is not any of them.
         </li>
         <li 
  class="enumerate" id="x1-14024x5">If <!--l. 194--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">≥</mo> <mn>0</mn></math>,
         update <!--l. 194--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.</li></ol>
     </li></ol>
<!--l. 198--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-1500010"></a>Example</h3>
     <ul class="itemize1">
     <li class="itemize">Let <!--l. 200--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mn>5</mn><mn>6</mn></math>
     the size of the source alphabet.
     </li>
     <li class="itemize">The probabilistic model <!--l. 201--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
     (for the special context <!--l. 202--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></math>)
     is static, non empty and has an special symbol <!--l. 202--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">EOF</mi></math>
     (End Of File) that is going to be used when the compression has ﬁnished:
                                                                  

                                                                  
     <!--tex4ht:inline--><!--l. 205--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" >
                     <mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="0.33em" class="nbsp" /><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="0.33em" class="nbsp" /><mo 
class="MathClass-rel">⋯</mo><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">b</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="0.33em" class="nbsp" /><mo 
class="MathClass-rel">⋯</mo><mspace width="0.33em" class="nbsp" /><mn>2</mn><mn>5</mn><mn>5</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">EOF</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><mo 
class="MathClass-punc">.</mo>
</math>
     <!--l. 205--><p class="nopar" > In a pair <!--l. 206--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>,
     <!--l. 206--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
     is the symbol and <!--l. 206--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
     is its probability (represented by a counter of ocurrences of <!--l. 206--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>
     in the processed input until that moment).
     </p></li>
     <li class="itemize"><!--l. 208--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
     is adaptative and empty:
     <!--tex4ht:inline--><!--l. 209--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" >
                                       <mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo>
</math>
     <!--l. 209--><p class="nopar" >
     </p></li>
     <li class="itemize">In this example (for the sake of the simplicity), the maximal order of the
     prediction <!--l. 212--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>
     (we only remember the previous symbol). Therefore, there are <!--l. 213--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mn>5</mn><mn>6</mn></math>
     probabilistic models:
                                                                  

                                                                  
     <!--tex4ht:inline--><!--l. 214--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" >
                               <mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">,</mo><mn>0</mn> <mo 
class="MathClass-rel">≤</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">≤</mo> <mi 
>r</mi><mo 
class="MathClass-punc">.</mo>
</math>
     <!--l. 214--><p class="nopar" >
     </p><!--l. 216--><p class="noindent" >
         </p><ol  class="enumerate1" >
         <li 
  class="enumerate" id="x1-15001x10"><!--l. 217--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo><mi mathvariant="monospace">a</mi></math>.
         </li>
         <li 
  class="enumerate" id="x1-15002x10"><!--l. 218--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>0</mn></math>
         (we don’t know the previous symbol).
         </li>
         <li 
  class="enumerate" id="x1-15003x10"><!--l. 219--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">a</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>
         (the context <!--l. 219--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
         has only the <!--l. 219--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">ESC</mi></math>
         symbol, <!--l. 219--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>).
         </li>
         <li 
  class="enumerate" id="x1-15004x10">Output <!--l. 220--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
         (in fact, zero bits because <!--l. 221--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>).
         </li>
         <li 
  class="enumerate" id="x1-15005x10">Update <!--l. 222--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
         (now, <!--l. 222--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>).
         </li>
         <li 
  class="enumerate" id="x1-15006x10">[3.C.c] Insert symbol <!--l. 223--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">a</mi></math>
         into <!--l. 224--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-15007x10">
         </li>
         <li 
  class="enumerate" id="x1-15008x10">
         </li>
         <li 
  class="enumerate" id="x1-15009x10"><!--l. 226--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">a</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-rel">≠</mo><mn>0</mn></math>.
         </li>
         <li 
  class="enumerate" id="x1-15010x10">Output <!--l. 227--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">a</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
         where <!--l. 228--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">a</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-bin">∕</mo><mrow ><mo 
class="MathClass-open">(</mo><mrow><mn>2</mn><mn>5</mn><mn>6</mn> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.</li></ol>
     </li>
     <li class="itemize">Encoding of the second symbol (<span 
class="ectt-1000">b</span>):
         <ol  class="enumerate1" >
         <li 
  class="enumerate" id="x1-15011x10"><!--l. 232--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo><mi mathvariant="monospace">b</mi></math>.
                                                                  

                                                                  
         </li>
         <li 
  class="enumerate" id="x1-15012x10"><!--l. 233--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>1</mn></math>.
         </li>
         <li 
  class="enumerate" id="x1-15013x10"><!--l. 234--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>
         because <!--l. 234--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="monospace">a</mi></math>
         and <!--l. 234--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-15014x10">Output <!--l. 235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
         with <!--l. 235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>.
         </li>
         <li 
  class="enumerate" id="x1-15015x10">Update <!--l. 236--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
         in <!--l. 236--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
         (now, <!--l. 236--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>).
         </li>
         <li 
  class="enumerate" id="x1-15016x10">Insert <!--l. 237--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">b</mi></math>
         into <!--l. 237--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">b</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-15017x10"><!--l. 238--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>0</mn></math>.
         </li>
         <li 
  class="enumerate" id="x1-15018x10"><!--l. 239--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>
         <!--l. 239--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-15019x10"><!--l. 240--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>
         because <!--l. 240--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-15020x10">Output <!--l. 241--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>,
         where <!--l. 241--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mo 
class="MathClass-bin">∕</mo><mn>3</mn></math>.
         </li>
         <li 
  class="enumerate" id="x1-15021x10">Update <!--l. 242--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
         (now, the count of <!--l. 242--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">ESC</mi></math>
         is <!--l. 242--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math>).
         </li>
         <li 
  class="enumerate" id="x1-15022x10">Insert <!--l. 243--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">b</mi></math>
         into <!--l. 243--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>3</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">b</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-15023x10"><!--l. 244--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo><mo 
class="MathClass-bin">−</mo><mn>1</mn></math>.
         </li>
         <li 
  class="enumerate" id="x1-15024x10"><!--l. 245--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-rel">≠</mo><mn>0</mn></math>.
         </li>
         <li 
  class="enumerate" id="x1-15025x10">Output <!--l. 246--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
         where <!--l. 246--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-bin">∕</mo><mi 
>r</mi></math>.
         The symbol <!--l. 246--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">a</mi></math>
                                                                  

                                                                  
         has been excluded of the calculus of the probability of <!--l. 246--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">b</mi></math>
         for context <!--l. 246--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
         because <!--l. 246--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">a</mi> <mo 
class="MathClass-rel">∈</mo> <mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>3</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="0.33em" class="nbsp" /><mi mathvariant="monospace">b</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>.</li></ol>
     </li></ul>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-150261"></a>
                                                                  

                                                                  
<!--l. 285--><p class="noindent" ><div style="text-align:center;"> <img width=800 src="graphics/PPM_example.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 1: </span><span  
class="content">An example of context-based statistical encoding.</span></div><!--tex4ht:label?: x1-150261 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">11   </span> <a 
 id="x1-1600011"></a>Decoder</h3>
<!--l. 293--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-16002x1">Equal to the step 1 of the encoder.
     </li>
     <li 
  class="enumerate" id="x1-16004x2">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-16006x1"><!--l. 297--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>k</mi></math>
         (except for the ﬁrst symbol, where <!--l. 298--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>0</mn></math>).
         </li>
         <li 
  class="enumerate" id="x1-16008x2"><!--l. 299--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo></math>
         next decoded symbol.
         </li>
         <li 
  class="enumerate" id="x1-16010x3">While <!--l. 300--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="monospace">ESC</mi></math>:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-16012x1">Update <!--l. 302--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
             </li>
             <li 
  class="enumerate" id="x1-16014x2"><!--l. 303--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>i</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></math>.
             </li>
             <li 
  class="enumerate" id="x1-16016x3"><!--l. 304--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo></math>
             next decoded symbol.</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-16018x4">Update <!--l. 306--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-16020x5">While <!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>k</mi></math>:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-16022x1"><!--l. 309--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>.
             </li>
             <li 
  class="enumerate" id="x1-16024x2">Update <!--l. 310--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
             (insert <!--l. 310--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>
             into the <!--l. 310--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
             context).</li></ol>
         </li></ol>
     </li></ol>
                                                                  

                                                                  
<!--l. 348--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-1700011"></a>Let’s go the the lab!</h3>
<!--l. 349--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-17002x1">
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-4">
              Codec | lena boats pepers zelda Average
      <br />---------------+--------------------------------
      <br />             : |    :     :      :     :       :
      <br />arith-n-c -o 1 | ....  ....   ....  ....    ....
      <br />arith-n-c -o 2 | ....  ....   ....  ....    ....
      <br />arith-n-c -o 3 | ....  ....   ....  ....    ....
</div>
     <!--l. 358--><p class="nopar" >
     </p></li>
     <li 
  class="enumerate" id="x1-17004x2">Check the reversibility.</li></ol>
<!--l. 1--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-1800011"></a>References</h3>
<!--l. 1--><p class="noindent" >
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">   </span></span><a 
 id="Xcleary1984data"></a>John Cleary and Ian Witten.  <a 
href="https://scholar.google.es/scholar?hl=es&as_sdt=0%2C5&q=Data+Compression+using+Adaptive+Coding+and+Partial+String+Matching&btnG=" >Data compression using adaptive coding
   and  partial  string  matching</a>.    <span 
class="ecti-1000">IEEE  transactions  on  Communications</span>,
   32(4):396–402, 1984.
</p>
   </div>
<a 
 id="Q1-1-20"></a>
    
</body> 
</html>
                                                                  


