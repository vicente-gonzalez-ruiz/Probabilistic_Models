<!DOCTYPE html> 
<html> 
<head> <title>Probabilistic models</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">Probabilistic models</h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">á</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">December 30, 2018</span></div>
   </div>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-10001" id="QQ2-1-1">Basics</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-80002" id="QQ2-1-8">Initially empty models</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-130003" id="QQ2-1-13">Models with memory</a></span>
<br />   <span class="likesectionToc" ><a 
href="#x1-180003.4" id="QQ2-1-18">References</a></span>
   </div>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Basics</h3>
     <ul class="itemize1">
     <li class="itemize">In order to use any of the previous VLCs (Variable Length Codecs), a
     probabilistic model is needed.</li></ul>
<!--l. 20--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-20001.1"></a>Static models</h4>
     <ul class="itemize1">
     <li class="itemize">Static   models   are   the   simplest   ones   because   they   suppose   that
     the   probabilities   of   the   symbols   remain   constant   through   the
     compression/decompression.
     </li>
     <li class="itemize">In this case, variable-length code-words can be precomputed.
                                                                  

                                                                  
     </li>
     <li class="itemize">Static models are very common in codecs such as JPEG and MPEG (audio
     and video).</li></ul>
<!--l. 34--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-30001.2"></a>Adaptive models</h4>
     <ul class="itemize1">
     <li class="itemize">The probabilities of the symbols are computed while they arrive to the
     compressor.
     </li>
     <li class="itemize">In general, the compression ratios that adaptive models reach are better
     than                                    static                                    model’s
     ones, because the probabilities of the symbols are localy computed (think
     of the sequence <span 
class="ectt-1000">aaaaaaaaaaaaaabbbbbbbbbbbbbbb</span>).</li></ul>
<!--l. 46--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.3   </span> <a 
 id="x1-40001.3"></a>Encoding</h4>
<!--l. 47--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-4002x1">Asign the same probability to all the symbols of the source alphabet.
     </li>
     <li 
  class="enumerate" id="x1-4004x2">While the input if not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-4006x1">Encode the next symbol.
         </li>
         <li 
  class="enumerate" id="x1-4008x2">Update (increase) its probability.</li></ol>
     </li></ol>
<!--l. 62--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.4   </span> <a 
 id="x1-50001.4"></a>Example</h4>
<!--l. 63--><p class="noindent" > <div style="text-align:center;"> <img width=800 src="graphics/adaptative-model-encoder.PNG" /> </div> 
                                                                  

                                                                  
</p><!--l. 65--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.5   </span> <a 
 id="x1-60001.5"></a>Decoding</h4>
<!--l. 66--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-6002x1">Identical to the step 1 of the encoder.
     </li>
     <li 
  class="enumerate" id="x1-6004x2">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-6006x1">Decode the next symbol.
         </li>
         <li 
  class="enumerate" id="x1-6008x2">Identical to the step 2.B of the encoder.</li></ol>
     </li></ol>
<!--l. 81--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.6   </span> <a 
 id="x1-70001.6"></a>Example</h4>
<!--l. 82--><p class="noindent" > <div style="text-align:center;"> <img width=800 src="graphics/adaptative-model-decoder.PNG" /> </div> 
</p><!--l. 84--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-80002"></a>Initially empty models</h3>
     <ul class="itemize1">
     <li class="itemize">The smaller the number of symbols used by the model, the higher the
     probabilities, and therefore, the better the compression ratios.
     </li>
     <li class="itemize">An initially empty model only stores the <!--l. 91--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">ESC</mi></mrow></math>(cape)
     symbol (a symbol that it is used by the encoder only when a new symbol
     is found and therefore, it must be part of the encoder’s and decoder’s
     models).
     </li>
     <li class="itemize">We assume that arithmetic coding is used and therefore, when we input or
     output <!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>,
     we are transmitting <!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>I</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     bits of code.</li></ul>
                                                                  

                                                                  
<!--l. 100--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-90002.1"></a>Encoder</h4>
<!--l. 101--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-9002x1">Set the probability of the <!--l. 104--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">ESC</mi></mrow></math>
     symbol to <!--l. 104--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>0</mn></mrow></math>
     (and the probability of the rest of the symbols to <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>0</mn></mrow></math>).
     </li>
     <li 
  class="enumerate" id="x1-9004x2">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-9006x1"><!--l. 111--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo></mrow></math>
         next symbol.
         </li>
         <li 
  class="enumerate" id="x1-9008x2">If <!--l. 113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
         has been found before, then:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-9010x1">Output <!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
             (encode).</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-9012x3">Else:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-9014x1">Output <!--l. 124--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.
             </li>
             <li 
  class="enumerate" id="x1-9016x2">Output a raw symbol <!--l. 126--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-9018x4">Update <!--l. 129--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.</li></ol>
     </li></ol>
<!--l. 133--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-100002.2"></a>Example</h4>
<!--l. 135--><p class="noindent" >TO-DO
</p><!--l. 137--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-110002.3"></a>Decoder</h4>
<!--l. 138--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-11002x1">Identical to the step 1 of the encoder.
                                                                  

                                                                  
     </li>
     <li 
  class="enumerate" id="x1-11004x2">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-11006x1"><!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">←</mo></math>
         next code-word.
         </li>
         <li 
  class="enumerate" id="x1-11008x2">Decode <!--l. 149--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-11010x3">If <!--l. 151--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="monospace">ESC</mi></mrow></math>,
         then:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-11012x1">Input a raw symbol <!--l. 155--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-11014x4">Update <!--l. 158--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-11016x5">Output <!--l. 160--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.</li></ol>
     </li></ol>
<!--l. 164--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-120002.4"></a>Example</h4>
<!--l. 166--><p class="noindent" >TO-DO
</p><!--l. 168--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-130003"></a>Models with memory</h3>
     <ul class="itemize1">
     <li class="itemize">In most cases, the probability of a symbol depends on its neighborhood
     (context).
     </li>
     <li class="itemize">The  higher  the  context,  the  higher  the  accuracy  of  the  predictions
     (probabilities), and therefore, the lower the length of the code-words <span class="cite">[<a 
href="#Xcleary1984data">1</a>]</span>.
     </li>
     <li class="itemize">Let <!--l. 179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
     the last <!--l. 179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>
     encoded symbols (the context) and <!--l. 180--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     the probability that the symbol <!--l. 180--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     follows the context <!--l. 181--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>.
                                                                  

                                                                  
     </li>
     <li class="itemize">Let <!--l. 183--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>
     the maximal order of the prediction (i.e. the largest number of symbols of
     <!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
     that are going to be used as the actual context). Notice that <!--l. 185--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-ord">∅</mo></mrow></math>
     and the model has no memory.
     </li>
     <li class="itemize">Let <!--l. 188--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi></mrow></math>
     the size of the source alphabet.</li></ul>
<!--l. 191--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-140003.1"></a>Encoder</h4>
<!--l. 192--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-14002x1">Create an empty model for every possible context of length <!--l. 196--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>0</mn> <mo 
class="MathClass-rel">≤</mo> <mi 
>i</mi> <mo 
class="MathClass-rel">≤</mo> <mi 
>k</mi></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-14004x2">Create an non-empty model for <!--l. 198--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-14006x3">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-14008x1"><!--l. 204--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo></mrow></math>
         Input <!--l. 204--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>r</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
         bits. # Input a symbol
         </li>
         <li 
  class="enumerate" id="x1-14010x2"><!--l. 206--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>k</mi></mrow></math>
         (except for the ﬁrst symbol, where <!--l. 207--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>0</mn></mrow></math>).
         </li>
         <li 
  class="enumerate" id="x1-14012x3">While <!--l. 209--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math> (it is the
         ﬁrst time that <!--l. 209--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
         follows <!--l. 210--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>):
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-14014x1">Output <!--l. 214--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.
             </li>
             <li 
  class="enumerate" id="x1-14016x2">Update <!--l. 216--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.
             </li>
             <li 
  class="enumerate" id="x1-14018x3">Update <!--l. 218--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
             (insert <!--l. 218--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
             into the <!--l. 218--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
             context).
             </li>
             <li 
  class="enumerate" id="x1-14020x4"><!--l. 221--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>i</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></mrow></math>.</li></ol>
                                                                  

                                                                  
         </li>
         <li 
  class="enumerate" id="x1-14022x4">Output <!--l. 224--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.
         The symbols that were found in the models for contexts with order
         <!--l. 225--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>i</mi></mrow></math> must be excluded
         of the actual (<!--l. 226--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>)
         context-model because, for sure,
         <!--l. 226--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
         is not any of them.
         </li>
         <li 
  class="enumerate" id="x1-14024x5">If <!--l. 229--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">≥</mo> <mn>0</mn></mrow></math>,
         update <!--l. 229--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.</li></ol>
     </li></ol>
<!--l. 233--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-150003.2"></a>Example</h4>
     <ul class="itemize1">
     <li class="itemize">Let <!--l. 236--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mn>5</mn><mn>6</mn></mrow></math>
     the size of the source alphabet.
     </li>
     <li class="itemize">The probabilistic model <!--l. 238--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
     (for the special context <!--l. 239--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>)
     is static, non empty and has an special symbol <!--l. 240--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">EOF</mi></mrow></math>
     (End Of File) that is going to be used when the compression has ﬁnished:
<div class="math-display"><!--l. 242--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
             <mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="1em" class="nbsp" /><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="1em" class="nbsp" /><mo 
class="MathClass-rel">⋯</mo><mspace width="1em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="1em" class="nbsp" /><mi mathvariant="monospace">b</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="1em" class="nbsp" /><mo 
class="MathClass-rel">⋯</mo><mspace width="1em" class="nbsp" /><mn>2</mn><mn>5</mn><mn>5</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="1em" class="nbsp" /><mi mathvariant="monospace">EOF</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>A</mi><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
     <!--l. 242--><p class="nopar" > In a pair <!--l. 243--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>,
     <!--l. 243--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>
     is the symbol and <!--l. 243--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
     is its probability (represented by a counter of ocurrences of <!--l. 244--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
                                                                  

                                                                  
     in the processed input until that moment).
     </p></li>
     <li class="itemize"><!--l. 247--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
     is adaptative and empty:
<div class="math-display"><!--l. 248--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                         <mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
     <!--l. 248--><p class="nopar" >
     </p></li>
     <li class="itemize">In this example (for the sake of the simplicity), the maximal order of the
     prediction <!--l. 251--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></mrow></math>
     (we only remember the previous symbol). Therefore, there are <!--l. 252--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mn>5</mn><mn>6</mn></mrow></math>
     probabilistic models:
<div class="math-display"><!--l. 253--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                   <mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">,</mo><mn>0</mn> <mo 
class="MathClass-rel">≤</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">≤</mo> <mi 
>r</mi><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
     <!--l. 253--><p class="nopar" >
     </p></li>
     <li class="itemize"><span 
class="ecbx-1000">Encoding of the ﬁrst symbol (</span><!--l. 255--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">a</mi></mrow></math><span 
class="ecbx-1000">)</span>
     (see the following ﬁgure):</li></ul>
<!--l. 259--><p class="noindent" >
                                                                  

                                                                  
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-15002x1">[3.A] <!--l. 263--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo><mi mathvariant="monospace">a</mi></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15004x2">[3.B] <!--l. 265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>0</mn></mrow></math>
     (we don’t know the previous symbol).
     </li>
     <li 
  class="enumerate" id="x1-15006x3">[3.C] <!--l. 267--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">a</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>
     (the context <!--l. 267--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
     has only the <!--l. 268--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">ESC</mi></mrow></math>
     symbol, <!--l. 268--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>).
     </li>
     <li 
  class="enumerate" id="x1-15008x4">[3.C.a] Output <!--l. 270--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     (in fact, zero bits because <!--l. 271--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>l</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>).
     </li>
     <li 
  class="enumerate" id="x1-15010x5">[3.C.b] Update <!--l. 273--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     (now, <!--l. 274--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>).
     </li>
     <li 
  class="enumerate" id="x1-15012x6">[3.C.c] Insert symbol <!--l. 276--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">a</mi></mrow></math>
     into <!--l. 277--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn><mspace width="1em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15014x7">[3.C.d] <!--l. 279--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15016x8">[3.C] <!--l. 281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">a</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-rel">≠</mo><mn>0</mn></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15018x9">[3.D] Output <!--l. 283--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">a</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     where <!--l. 284--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">a</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-bin">∕</mo><mrow ><mo 
class="MathClass-open">(</mo><mrow><mn>2</mn><mn>5</mn><mn>6</mn> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.</li></ol>
     <ul class="itemize1">
     <li class="itemize"><span 
class="ecbx-1000">Encoding of the second symbol (</span><!--l. 290--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">b</mi></mrow></math><span 
class="ecbx-1000">)</span>:</li></ul>
<!--l. 293--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-15020x1">[3.A] <!--l. 297--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo><mi mathvariant="monospace">b</mi></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15022x2">[3.B] <!--l. 299--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>1</mn></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15024x3">[3.C] <!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>
     because <!--l. 302--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="monospace">a</mi></mrow></math>
     andv<!--l. 302--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15026x4">[3.A.a] Output <!--l. 304--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     with <!--l. 305--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>l</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15028x5">[3.A.b] Update <!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
                                                                  

                                                                  
     in <!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
     (now, <!--l. 308--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>).
     </li>
     <li 
  class="enumerate" id="x1-15030x6">[3.C.c] Insert <!--l. 310--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">b</mi></mrow></math>
     into <!--l. 311--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">a</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn><mspace width="1em" class="nbsp" /><mi mathvariant="monospace">b</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15032x7">[3.C.d] <!--l. 313--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>0</mn></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15034x8">[3.C] <!--l. 315--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>
     because <!--l. 315--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn><mspace width="1em" class="nbsp" /><mi 
>t</mi><mi 
>e</mi><mi 
>x</mi><mi 
>t</mi><mi 
>t</mi><mi 
>t</mi><mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15036x9">[3.C.a] Output <!--l. 317--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>,
     where <!--l. 318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mo 
class="MathClass-bin">∕</mo><mn>3</mn></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15038x10">[3.C.b] Update <!--l. 320--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     (now, the count of <!--l. 321--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">ESC</mi></mrow></math>
     is <!--l. 321--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>).
     </li>
     <li 
  class="enumerate" id="x1-15040x11">[3.C.c] Insert <!--l. 323--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">b</mi></mrow></math>
     into <!--l. 324--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>3</mn><mspace width="1em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="1em" class="nbsp" /><mi mathvariant="monospace">b</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15042x12">[3.C.d] <!--l. 326--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15044x13">[3.C] <!--l. 328--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-rel">≠</mo><mn>0</mn></mrow></math>.
     </li>
     <li 
  class="enumerate" id="x1-15046x14">[3.D] Output <!--l. 330--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">←</mo> <mi 
>c</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
     where <!--l. 331--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">b</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-bin">∕</mo><mi 
>r</mi></mrow></math>.
     The symbol <!--l. 331--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">a</mi></mrow></math>
     has been excluded of the calculus of the probability of <!--l. 332--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">b</mi></mrow></math>
     for context <!--l. 333--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>C</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
     because <!--l. 334--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="monospace">a</mi> <mo 
class="MathClass-rel">∈</mo> <mi 
>M</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-punc">,</mo><mn>3</mn><mspace width="1em" class="nbsp" /><mi mathvariant="monospace">a</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn><mspace width="1em" class="nbsp" /><mi mathvariant="monospace">b</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mo 
class="MathClass-close">}</mo></mrow></mrow></math>.</li></ol>
<!--l. 336--><p class="noindent" > <div style="text-align:center;"> <img width=600 src="graphics/PPM_example.png" /> </div> 
</p><!--l. 338--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-160003.3"></a>Decoder</h4>
<!--l. 339--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-16002x1">Equal to the step 1 of the encoder.
     </li>
     <li 
  class="enumerate" id="x1-16004x2">While the input is not exhausted:
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-16006x1"><!--l. 350--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>k</mi></mrow></math>
                                                                  

                                                                  
         (except for the ﬁrst symbol, where <!--l. 351--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mn>0</mn></mrow></math>).
         </li>
         <li 
  class="enumerate" id="x1-16008x2"><!--l. 353--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo></mrow></math>
         next decoded symbol.
         </li>
         <li 
  class="enumerate" id="x1-16010x3">While <!--l. 355--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="monospace">ESC</mi></mrow></math>:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-16012x1">Update <!--l. 360--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi mathvariant="monospace">ESC</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.
             </li>
             <li 
  class="enumerate" id="x1-16014x2"><!--l. 362--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>i</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></mrow></math>.
             </li>
             <li 
  class="enumerate" id="x1-16016x3"><!--l. 364--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi> <mo 
class="MathClass-rel">←</mo></mrow></math>
             next decoded symbol.</li></ol>
         </li>
         <li 
  class="enumerate" id="x1-16018x4">Update <!--l. 367--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>.
         </li>
         <li 
  class="enumerate" id="x1-16020x5">While <!--l. 369--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>k</mi></mrow></math>:
             <ol  class="enumerate3" >
             <li 
  class="enumerate" id="x1-16022x1"><!--l. 374--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>.
             </li>
             <li 
  class="enumerate" id="x1-16024x2">Update <!--l. 376--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>p</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mo 
class="MathClass-rel">|</mo><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></math>
             (insert <!--l. 376--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
             into the <!--l. 376--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
mathvariant="bold-script">𝒞</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></math>
             context).</li></ol>
         </li></ol>
     </li></ol>
<!--l. 382--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-170003.4"></a>Lab</h4>
<!--l. 384--><p class="noindent" >TO-DO
</p><!--l. 1--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-180003.4"></a>References</h3>
<!--l. 1--><p class="noindent" >
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">   </span></span><a 
 id="Xcleary1984data"></a>John Cleary and Ian Witten.  <a 
href="https://scholar.google.es/scholar?hl=es&as_sdt=0%2C5&q=Data+Compression+using+Adaptive+Coding+and+Partial+String+Matching&btnG=" >Data compression using adaptive coding
   and  partial  string  matching</a>.    <span 
class="ecti-1000">IEEE  transactions  on  Communications</span>,
   32(4):396–402, 1984.
                                                                  

                                                                  
</p>
   </div>
    
</body> 
</html>
                                                                  


